{"version":3,"sources":["../js/main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["/* jshint -W097 */\n/* jshint -W117 */\n'use strict';\n\nclass Forest {\n  constructor(width, height) {\n    this.width = width || Math.floor($('.wrapper').width() / $('#sizeTest').width());\n    this.height = height || Math.floor($('.wrapper').height() / $('#sizeTest').height());\n    this.map = [];\n    this.$mapElem = $('#map');\n\n    this.createMap();\n    this.createMapElem();\n\n    this.loseFireProb = 0.1;\n    this.catchFireProb = 0.1;\n    this.spreadTreeProb = 0.0025;\n    this.spreadFireProb = 0.1;\n    this.newTreeProb = 0.0001;\n    this.newFireProb = 0.00001;\n  }\n\n  restart() {\n    this.createMap();\n    this.createMapElem();\n  }\n\n  createMap() {\n    console.log('creating the map...');\n    this.map = [];\n    for (var i = 0; i < this.height; i++){\n      var row = [];\n      for (var j = 0; j < this.width; j++)\n        row.push(new Tree());\n      this.map.push(row);\n    }\n  }\n\n  createMapElem() {\n    console.log('creating the map element...');\n    this.$mapElem.text('');\n    for (var i = 0; i < this.map.length; i++) {\n      for (var j = 0; j < this.map[i].length; j++) {\n        this.$mapElem.append(\n          `<span id=\"tree-${j}-${i}\" class=\"emj\">${this.map[i][j].symbol}</span>`\n        );\n      }\n      this.$mapElem.append( '<br>' );\n    }\n  }\n\n  update() {\n    console.log('updating');\n    for (var i = 0; i < this.map.length; i++) {\n      for (var j = 0; j < this.map[i].length; j++) {\n\n        this.randomSpawns(j, i);\n\n        switch (this.map[i][j].id) {\n          case TreeInfo.Empty.id:\n            break;\n\n          case TreeInfo.Burning.id:\n            this.spreadFires(j, i);\n\n            if (Math.random() < this.loseFireProb)\n              this.map[i][j].destroy();\n\n            break;\n          case TreeInfo.Heating.id:\n            if (Math.random() < this.catchFireProb)\n              this.map[i][j].burn();\n\n            break;\n          case TreeInfo.Tree.id:\n            this.speadTrees(j, i);\n            break;\n        }\n\n        this.render(j, i);\n      }\n    }\n    window.setTimeout(() => this.update(), 1000 / 60);\n  }\n\n  randomSpawns(x, y) {\n    if (Math.random() < this.newTreeProb) {\n      this.map[y][x].plant();\n    }\n\n    if (Math.random() < this.newFireProb) {\n      if (this.map[y][x].id == TreeInfo.Tree.id) {\n        this.map[y][x].heat();\n      }\n    }\n  }\n\n  speadTrees(x, y) {\n    var positions = [[1, 1], [1, 0], [0, 1], [-1, -1], [-1, 0], [0, -1], [-1, 1], [-1, 1]];\n    for (var i = 0; i < positions.length; i++) {\n      if (Math.random() < this.spreadTreeProb) {\n        var xN = x + positions[i][0];\n        var yN = y + positions[i][1];\n\n        try {\n          if (this.map[yN][xN].state == TreeInfo.Empty.state)\n            this.map[yN][xN].plant();\n        } catch (e) { }\n      }\n    }\n  }\n\n  spreadFires(x, y) {\n    var positions = [[1, 1], [1, 0], [0, 1], [-1, -1], [-1, 0], [0, -1], [-1, 1], [-1, 1]];\n    for (var i = 0; i < positions.length; i++) {\n      if (Math.random() < this.spreadFireProb) {\n        var xN = x + positions[i][0];\n        var yN = y + positions[i][1];\n\n        try {\n          if (this.map[yN][xN].state == TreeInfo.Tree.state)\n            this.map[yN][xN].heat();\n        } catch (e) { }\n      }\n    }\n  }\n\n  render(x, y) {\n    // console.log(`rendering (${x}, ${y})`);\n    $(`#tree-${x}-${y}`).html(this.map[y][x].symbol);\n  }\n}\n\nclass Tree {\n  constructor() {\n    this.info = TreeInfo.Empty;\n  }\n\n  get id() {\n    return this.info.id;\n  }\n\n  get state() {\n    return this.info.state;\n  }\n\n  set state(thing) {\n    this.info = thing;\n  }\n\n  get symbol() {\n    return this.info.symbol;\n  }\n\n  destroy() {\n    this.state = TreeInfo.Empty;\n  }\n  plant() {\n    this.state = TreeInfo.Tree;\n  }\n  heat() {\n    this.state = TreeInfo.Heating;\n  }\n  burn() {\n    this.state = TreeInfo.Burning;\n  }\n}\n\nvar TreeInfo = {\n  Empty: {\n    id: 0,\n    state: 'empty',\n    // symbol: '<i class=\"twa twa-fallen-leaf\"/>' //\n    symbol: '🍂'\n  },\n  Tree: {\n    id: 1,\n    state: 'tree',\n    // symbol: '<i class=\"twa twa-evergreen-tree\"/>' //\n    symbol: '🌲'\n  },\n  Heating: {\n    id: 2,\n    state: 'heating',\n    // symbol: '<i class=\"twa twa-maple-leaf\"/>' //\n    symbol: '🍁'\n  },\n  Burning: {\n    id: 3,\n    state: 'burning',\n    // symbol: '<i class=\"twa twa-fire\"/>' //\n    symbol: '🔥'\n  },\n};\n\n\nvar f = new Forest();\nf.update();\n\nvar gui = new dat.GUI();\ngui.add(f, 'loseFireProb', 0, 0.1);\ngui.add(f, 'catchFireProb', 0, 0.1);\ngui.add(f, 'spreadTreeProb', 0, 0.1);\ngui.add(f, 'spreadFireProb', 0, 0.1);\ngui.add(f, 'newTreeProb', 0, 0.1);\ngui.add(f, 'newFireProb', 0, 0.1);\ngui.add(f, 'restart');\n"]}